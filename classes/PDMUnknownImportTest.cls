@isTest(seeAlldata=true)
private class PDMUnknownImportTest {

    static testMethod void myUnitTest() {

		List<RecordType> pdmRecord = [Select Id from RecordType where Name = 'PDM Unknown'];
		List<Group> pdmQueue = [SELECT Id FROM Group where type = 'Queue' and name = 'PDM Unknown'];
    	Case c = new Case();
    	c.RecordTypeId = pdmRecord[0].Id;
    	c.OwnerId = pdmQueue[0].Id;
    	c.Provider_ID__c = '215773';
    	c.Payer_Name__c = 'PAYERNAME';
    	c.NPI_Identifier__c = '1275511289';
    	c.Tax_ID__c = '123456789';
   		insert c;
    	c = new Case();
    	c.RecordTypeId = pdmRecord[0].Id;
    	c.OwnerId = pdmQueue[0].Id;
    	c.Provider_ID__c = '215772';
    	c.Payer_Name__c = 'PAYERNAME';
    	c.NPI_Identifier__c = '1255545067';
    	c.Tax_ID__c = '1255545067';
   		insert c;
    	c = new Case();
    	c.RecordTypeId = pdmRecord[0].Id;
    	c.OwnerId = pdmQueue[0].Id;
    	c.Provider_ID__c = '32456';
    	c.Payer_Name__c = 'PAYERNAME';
    	c.NPI_Identifier__c = '7605455521';
    	c.Tax_ID__c = '987654323';
   		insert c;
    	c = new Case();
    	c.RecordTypeId = pdmRecord[0].Id;
    	c.OwnerId = pdmQueue[0].Id;
    	c.Provider_ID__c = '56478';
    	c.Payer_Name__c = 'PAYERNAME';
    	c.NPI_Identifier__c = '7605455521';
    	c.Tax_ID__c = '987654321';
   		insert c;

		Test.startTest();
		
		Test.setCurrentPageReference(new PageReference('Page.PDMUnknownImport'));
		// create file of sufficient size for code coverage
//        String csvAsString = 'MDM_SRCCD,PROVIDER_KEY,FIRST_NM,LAST_NM,TIN,HASH_VALUE,LOAD_DT,MDM_EID,MDM_SRCCD,MDM_SRCUID,TAXONOMY_CD,TAXONOMY_DESC,BUS_NM,PRACTICE_COUNTY,PRACTICE_STATE,TITLE,MIDDLE_NM,NM_SUFFIX,NM_PREFIX,NM_DEGREE,GENDER,DOB,ENTHNICITY_DESC,ETHNICITY_TYPE_CD,PRI_STREET_LINE_1,PRI_STREET_LINE_2,PRI_CITY,PRI_STATE,PRI_ZIP_CD,PRI_HOME_PHONE_NUM,PRI_ALTERNATE_PHONE_NUM,PRI_EMAIL,BILLING_COMPANY,BILLING_ADMIN_FIRST_NM,BILLING_ADMIN_MIDDLE_NM,BILLING_ADMIN_LAST_NM,BILLING_ADMIN_NAME_PREFIX,BILLING_ADMIN_NM_SUFFIX,BILLING_ADMIN_DEGREE,BILLING_ADMIN_TITLE,BILL_STREET_LINE_1,BILL_STREET_LINE_2,BILL_CITY,BILL_STATE,BILL_ZIP_CD,BILL_HOME_PHONE_NUM,BILL_ALTERNATE_PHONE_NUM,BILL_EMAIL,BILL_EFFECTIVE_DT,BILL_EXPIRE_DT,BILL_END_REASON_CD,BILL_END_REASON_DESC,BILL_FAX_NUM,PRI_FAX_NUM,UNIQUE_PHY_ID,CARE_ID,CAID_ID,CARE_OPT_OUT,CARE_OPT_OUT_DT,DEBARRED_FROM_CARE,CARE_ASSIGNED_DT,PRI_SPECIALTY,PRI_TAXONOMY_CD,PRI_TAXONOMY_TYPE,PRI_TAXONOMY_CLASS,PRI_TAXONOMY_SPECIALTY,NPI,MDM_LSPD_DT,PROVIDER_ID,CREATE_DT,LOAD_ID,LSPD_DT,LSPD_ID,SSN,NPPES Info,NPI_ID,ENTITY_TYPE_CD,LAST_UPDATED_DT,ORG_NM,STREET1,STREET2,CITY,STATE,POSTAL_CD,PHONE_NUM,FAX_NUM,Availity Registration Info,PARTY_ID,PARTY_NM,TAX_ID,SITE_ID,PARTY_ROLE_CD,PARTY_ROLE_DESC,CURRENT_STATUS_DESC,CURRENT_STATUS_EFFECTIVE_DT,PHYSICAL_STREET1,PHYSICAL_STREET2,PHYSICAL_CITY,PHYSICAL_STATE_CD,PHYSICAL_ZIP5,PAA_FIRST_NM,PAA_LAST_NM,PAA_PHONE,PAA_EXTENSION,PAA_EMAIL\n';
		String csvAsString = 'MDM_SRCCD,PROVIDER_KEY,FIRST_NM,LAST_NM,TIN,HASH_VALUE,LOAD_DT,MDM_EID,MDM_SRCUID,TAXONOMY_CD,TAXONOMY_DESC,BUS_NM,PRACTICE_COUNTY,PRACTICE_STATE,TITLE,MIDDLE_NM,NM_SUFFIX,NM_PREFIX,NM_DEGREE,GENDER,DOB,ENTHNICITY_DESC,ETHNICITY_TYPE_CD,PRI_STREET_LINE_1,PRI_STREET_LINE_2,PRI_CITY,PRI_STATE,PRI_ZIP_CD,PRI_HOME_PHONE_NUM,PRI_ALTERNATE_PHONE_NUM,PRI_EMAIL,BILLING_COMPANY,BILLING_ADMIN_FIRST_NM,BILLING_ADMIN_MIDDLE_NM,BILLING_ADMIN_LAST_NM,BILLING_ADMIN_NAME_PREFIX,BILLING_ADMIN_NM_SUFFIX,BILLING_ADMIN_DEGREE,BILLING_ADMIN_TITLE,BILL_STREET_LINE_1,BILL_STREET_LINE_2,BILL_CITY,BILL_STATE,BILL_ZIP_CD,BILL_HOME_PHONE_NUM,BILL_ALTERNATE_PHONE_NUM,BILL_EMAIL,BILL_EFFECTIVE_DT,BILL_EXPIRE_DT,BILL_END_REASON_CD,BILL_END_REASON_DESC,BILL_FAX_NUM,PRI_FAX_NUM,UNIQUE_PHY_ID,CARE_ID,CAID_ID,CARE_OPT_OUT,CARE_OPT_OUT_DT,DEBARRED_FROM_CARE,CARE_ASSIGNED_DT,PRI_SPECIALTY,PRI_TAXONOMY_CD,PRI_TAXONOMY_TYPE,PRI_TAXONOMY_CLASS,PRI_TAXONOMY_SPECIALTY,NPI,MDM_LSPD_DT,PROVIDER_ID,CREATE_DT,LOAD_ID,LSPD_DT,LSPD_ID,SSN,NPI_ID,ENTITY_TYPE_CD,LAST_UPDATED_DT,ORG_NM,STREET1,STREET2,CITY,STATE,POSTAL_CD,PHONE_NUM,FAX_NUM,PARTY_ID,PARTY_NM,TAX_ID,SITE_ID,PARTY_ROLE_CD,PARTY_ROLE_DESC,CURRENT_STATUS_DESC,CURRENT_STATUS_EFFECTIVE_DT,PHYSICAL_STREET1,PHYSICAL_STREET2,PHYSICAL_CITY,PHYSICAL_STATE_CD,PHYSICAL_ZIP5,PAA_FIRST_NM,PAA_LAST_NM,PAA_PHONE,PAA_EXTENSION,PAA_EMAIL';
        csvAsString += 'AVMEDPRVD,"34,802,",ZACHARIAH P,ZACHARIAH,,,"Mar 7, 2016 11:13:51 AM",46915923,51724145,,,,,,,,,,,M,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,207RC0000X,,,,,,,215773,"Mar 7, 2016 11:13:51 AM",AV_DW_STAGE,"Mar 7, 2016 11:13:51 AM",AV_DW_STAGE,,"1,275,511,289",1,"Feb 15, 2016 12:00:00 AM",,6405 N FEDERAL HIGHWAY,STE 200,FORT LAUDERDALE,FL,333081412,9547722200,9547722236,,,,,,,,,,,,,,,,,,email@email.com\n';
        csvAsString += 'AVMEDPRVD,"34,802,",ZACHARIAH P,ZACHARIAH,123456789,,"Mar 7, 2016 11:13:51 AM",46915923,51724145,,,,,,,,,,,M,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,207RC0000X,,,,,1275511289,,123,"Mar 7, 2016 11:13:51 AM",AV_DW_STAGE,"Mar 7, 2016 11:13:51 AM",AV_DW_STAGE,,"1,275,511,289",1,"Feb 15, 2016 12:00:00 AM",,6405 N FEDERAL HIGHWAY,STE 200,FORT LAUDERDALE,FL,333081412,9547722200,9547722236,,,,,,,,,,,,,,,,,,email@email.com\n';
        csvAsString += 'AVMEDPRVD,"34,802,",ZACHARIAH P,ZACHARIAH,123456789,,"Mar 7, 2016 11:13:51 AM",46915923,51724145,,,,,,,,,,,M,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,207RC0000X,,,,,1275511289,,456,"Mar 7, 2016 11:13:51 AM",AV_DW_STAGE,"Mar 7, 2016 11:13:51 AM",AV_DW_STAGE,,"1,275,511,289",1,"Feb 15, 2016 12:00:00 AM",,6405 N FEDERAL HIGHWAY,STE 200,FORT LAUDERDALE,FL,333081412,9547722200,9547722236,,,,,,,,,,,,,,,,,,email@email.com\n';
		csvAsString += 'AVMEDPRVD,"34,803",MEETA,GOVINDARAJAN,,,3/7/2016 11:13,46915931,51726659,,,,,,,,,,,F,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,207R00000X,,,,,1255545067,,789,3/7/2016 11:13,AV_DW_STAGE,3/7/2016 11:13,AV_DW_STAGE,,"1,255,545,067",1,6/25/2013 0:00,,501 NW 179TH AVENUE,,PEMBROKE PINES,FL,330292807,9544422828,9544423366,,,,,,,,,,,,,,,,,,email@email.com\n';
		csvAsString += 'AVMEDPRVD,"34,803",MEETA,GOVINDARAJAN,,,3/7/2016 11:13,46915931,51726659,,,,,,,,,,,F,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,207R00000X,,,,,1255545067,,987,3/7/2016 11:13,AV_DW_STAGE,3/7/2016 11:13,AV_DW_STAGE,,"1,255,545,067",1,6/25/2013 0:00,,501 NW 179TH AVE,,PEMBROKE PINES,FL,330292807,9544422828,9544423366,,,,,,,,,,,,,,,,,,email@email.com\n';
        csvAsString += 'AVMEDPRVD,"34,802,",ZACHARIAH P,ZACHARIAH,,,"Mar 7, 2016 11:13:51 AM",46915923,51724145,,,,,,,,,,,M,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,207RC0000X,,,,,,,654,"Mar 7, 2016 11:13:51 AM",AV_DW_STAGE,"Mar 7, 2016 11:13:51 AM",AV_DW_STAGE,,"1,275,511,289",1,"Feb 15, 2016 12:00:00 AM",,6405 N FEDERAL HIGHWAY,STE 200,FORT LAUDERDALE,FL,333081412,9547722200,9547722236,,,,,,,,,,,,,,,,,,email@email.com\n';
        csvAsString += 'AVMEDPRVD,"34,802,",ZACHARIAH P,ZACHARIAH,987654321,,"Mar 7, 2016 11:13:51 AM",46915923,51724145,,,,,,,,,,,M,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,207RC0000X,,,,,987654321,,477512,"Mar 7, 2016 11:13:51 AM",AV_DW_STAGE,"Mar 7, 2016 11:13:51 AM",AV_DW_STAGE,,"1,275,511,289",1,"Feb 15, 2016 12:00:00 AM",,6405 N FEDERAL HIGHWAY,STE 200,FORT LAUDERDALE,FL,333081412,9547722200,9547722236,,,,,,,,,,,,,,,,,,email@email.com\n';
        csvAsString += 'AVMEDPRVD,"34,802,",ZACHARIAH P,ZACHARIAH,,,"Mar 7, 2016 11:13:51 AM",46915923,51724145,,,,,,,,,,,M,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,207RC0000X,,,,,987654321,,377512,"Mar 7, 2016 11:13:51 AM",AV_DW_STAGE,"Mar 7, 2016 11:13:51 AM",AV_DW_STAGE,,"1,275,511,289",1,"Feb 15, 2016 12:00:00 AM",,6405 N FEDERAL HIGHWAY,STE 200,FORT LAUDERDALE,FL,333081412,9547722200,9547722236,,,,,,,,,,,,,,,,,,email@email.com\n';
		csvAsString += 'AVMEDPRVD,"34,803",MEETA,GOVINDARAJAN,,,3/7/2016 11:13,46915931,51726659,,,,,,,,,,,F,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,207R00000X,,,,,7605455521,,377512,3/7/2016 11:13,AV_DW_STAGE,3/7/2016 11:13,AV_DW_STAGE,,"1,255,545,067",1,6/25/2013 0:00,,501 NW 179TH AVENUE,,PEMBROKE PINES,FL,330292807,9544422828,9544423366,,,,,,,,,,,,,,,,,,email@email.com\n';
		csvAsString += 'AVMEDPRVD,"34,803",MEETA,GOVINDARAJAN,,,3/7/2016 11:13,46915931,51726659,,,,,,,,,,,F,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,207R00000X,,,,,7605455521,,,3/7/2016 11:13,AV_DW_STAGE,3/7/2016 11:13,AV_DW_STAGE,,"1,255,545,067",1,6/25/2013 0:00,,501 NW 179TH AVE,,PEMBROKE PINES,FL,330292807,9544422828,9544423366,,,,,,,,,,,,,,,,,,email@email.com\n';
        for(Integer i=1;i<1020;i++) {
			csvAsString += 'AVMEDPRVD,"34,805",LEON F,COHN,,,"Mar 7, 2016 11:13:51 AM",46915941,51725936,,,,,,,,,,,M,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,207W00000X,,,,,163913636'+i+',,202264'+i+',"Mar 7, 2016 11:13:51 AM",AV_DW_STAGE,"Mar 7, 2016 11:13:51 AM",AV_DW_STAGE,,"1,639,136,369",1,"Dec 8, 2015 12:00:00 AM",,499 NW 70 AVENUE,SUITE 100,PLANTATION,FL,33317,9547926411,9547924460,,,,,,,,,,,,,,,,,,email@email.com\n';
		}
		Blob csvFileBody = Blob.valueOf(csvAsString);
		PDMUnknownImport pdmTest = new PDMUnknownImport();
		pdmTest.csvFileBody = csvFileBody;
		pdmTest.importCSVFile();
		pdmTest.importCases();
		pdmTest.clearImport();

		Test.stopTest();        
    }
}